---
# This play will generate the required repositories for the OpenShift Container Platform Images product
# 

- name: Determine if the Custom Product Exists Already
  command: "hammer product info --organization='{{ cp.org }}' --name={{ cp.name }}"
  register: cp_exists
  ignore_errors: true

- name: Create the Product {{ cp.name }}
  command: "hammer product create --name={{ cp.name }} --label={{ cp.label }} --organization='{{ cp.org }}' --description='{{ cp.desc }}'"
  when: "cp_exists.stdout == ''"

- name: Create the Repositories for the required container images
  include_task: add_custom_product_repo.yml
  loop: "{{ cp.repository_name }}"
  loop_control: 
    loop_var: cpr

